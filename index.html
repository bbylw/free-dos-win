<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sovereign OS | Root Access</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        winTeal: '#008080',
                        winGray: '#c0c0c0',
                        winDarkGray: '#808080',
                        winBlue: '#0000a8',
                        dosBlack: '#000000',
                        dosWhite: '#aaaaaa',
                    },
                    fontFamily: {
                        dos: ['"VT323"', 'monospace'],
                        win: ['"Tahoma"', '"MS Sans Serif"', 'sans-serif'],
                        term: ['"Courier New"', 'monospace'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts for DOS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            overflow: hidden;
            background-color: #000;
        }

        /* --- CRT Â±èÂπïÈÄöÁî®ÊïàÊûú --- */
        .crt-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            pointer-events: none;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            opacity: 0.3;
        }
        
        /* Â±èÂπïÈó™ÁÉÅÈó™ÁôΩÊïàÊûú */
        #screen-flash {
            position: fixed;
            inset: 0;
            background: white;
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
        }

        /* --- Èò∂ÊÆµ 1ÔºöDOS ÂêØÂä®Â±èÂπï --- */
        #dos-screen {
            position: fixed;
            inset: 0;
            background-color: #000;
            color: #aaa;
            font-family: 'VT323', monospace;
            font-size: 20px;
            padding: 20px;
            z-index: 500;
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }
        .dos-cursor {
            display: inline-block;
            width: 10px;
            height: 20px;
            background-color: #aaa;
            animation: blink 1s step-end infinite;
            vertical-align: bottom;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        /* --- Èò∂ÊÆµ 2ÔºöWin9x Ê°åÈù¢ --- */
        #win-desktop {
            position: fixed;
            inset: 0;
            background-color: #008080; /* Classic Teal */
            font-family: "Tahoma", "MS Sans Serif", sans-serif;
            font-size: 11px;
            display: none; /* ÂàùÂßãÈöêËóè */
            z-index: 100;
        }

        /* Ê°åÈù¢ÂõæÊ†á */
        .desktop-icon {
            width: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
            cursor: pointer;
        }
        .desktop-icon img, .desktop-icon svg {
            width: 32px;
            height: 32px;
            margin-bottom: 4px;
            filter: drop-shadow(1px 1px 0px rgba(0,0,0,0.5));
        }
        .desktop-icon span {
            color: white;
            text-align: center;
            text-shadow: 1px 1px 0 #000;
            padding: 1px 3px;
        }
        .desktop-icon:active span, .desktop-icon.selected span {
            background-color: #000080;
            color: white;
            border: 1px dotted #fff;
        }

        /* Win9x Á™óÂè£ÁªÑ‰ª∂ */
        .win-window {
            position: absolute;
            background-color: #c0c0c0;
            border-top: 1px solid #fff;
            border-left: 1px solid #fff;
            border-right: 1px solid #000;
            border-bottom: 1px solid #000;
            box-shadow: inset 1px 1px #dfdfdf, inset -1px -1px #808080, 1px 1px 0 #000;
            display: flex;
            flex-direction: column;
            min-width: 200px;
            min-height: 100px;
            display: none; /* ÂàùÂßãÈöêËóè */
        }
        .win-titlebar {
            background-color: #0000a8;
            color: white;
            padding: 2px 3px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            cursor: default;
        }
        .win-titlebar.inactive {
            background-color: #808080;
        }
        .win-controls {
            display: flex;
            gap: 2px;
        }
        .win-btn {
            width: 16px;
            height: 14px;
            background-color: #c0c0c0;
            border-top: 1px solid #fff;
            border-left: 1px solid #fff;
            border-right: 1px solid #000;
            border-bottom: 1px solid #000;
            color: black;
            font-size: 9px;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        .win-btn:active {
            border-top: 1px solid #000;
            border-left: 1px solid #000;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            padding-top: 1px;
            padding-left: 1px;
        }
        .win-menu {
            display: flex;
            padding: 1px 5px;
            border-bottom: 1px solid #808080;
            gap: 10px;
        }
        .win-menu span {
            cursor: pointer;
        }
        .win-menu span::first-letter { text-decoration: underline; }
        .win-content {
            flex-grow: 1;
            padding: 2px;
            background-color: #c0c0c0;
            overflow: auto;
        }
        .win-inner-box {
            background-color: #fff;
            border-top: 1px solid #808080;
            border-left: 1px solid #808080;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            box-shadow: inset 1px 1px #000, inset -1px -1px #dfdfdf;
            padding: 5px;
            height: 100%;
            color: black;
            cursor: text;
            user-select: text;
        }

        /* Â∫ïÈÉ®‰ªªÂä°Ê†è */
        #taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 28px;
            background-color: #c0c0c0;
            border-top: 1px solid #fff;
            display: flex;
            align-items: center;
            padding: 2px;
            z-index: 1000;
        }
        .start-btn {
            height: 100%;
            padding: 0 5px;
            display: flex;
            align-items: center;
            font-weight: bold;
            background-color: #c0c0c0;
            border-top: 1px solid #fff;
            border-left: 1px solid #fff;
            border-right: 1px solid #000;
            border-bottom: 1px solid #000;
            cursor: pointer;
            box-shadow: inset 1px 1px #dfdfdf, inset -1px -1px #808080;
        }
        .start-btn:active {
            border-top: 1px solid #000;
            border-left: 1px solid #000;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            box-shadow: none;
            padding-top: 1px;
            padding-left: 6px;
        }
        .taskbar-divider {
            width: 2px;
            height: 80%;
            border-left: 1px solid #808080;
            border-right: 1px solid #fff;
            margin: 0 4px;
        }
        .taskbar-items {
            flex-grow: 1;
            display: flex;
            gap: 2px;
        }
        .taskbar-item {
            padding: 2px 5px;
            border-top: 1px solid #fff;
            border-left: 1px solid #fff;
            border-right: 1px solid #000;
            border-bottom: 1px solid #000;
            font-weight: bold;
            min-width: 100px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .taskbar-item.active {
            border-top: 1px solid #000;
            border-left: 1px solid #000;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            background-color: #dfdfdf;
            background-image: radial-gradient(#c0c0c0 1px, transparent 1px);
            background-size: 2px 2px;
        }
        .tray {
            border-top: 1px solid #808080;
            border-left: 1px solid #808080;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            padding: 0 8px;
            display: flex;
            align-items: center;
            height: 100%;
        }

        /* ÂÖ∑‰ΩìÁ™óÂè£ÂÜÖÂÆπÊ†∑Âºè */
        .notepad-text {
            font-family: 'Courier New', Courier, monospace;
            font-size: 13px;
            line-height: 1.5;
            white-space: pre-wrap;
        }
        
        .ms-dos-inner {
            background-color: #000;
            color: #c0c0c0;
            font-family: 'Courier New', Courier, monospace;
            padding: 5px;
            height: 100%;
            overflow-y: auto;
            border: inset 2px #fff; /* Simplified border for DOS inner */
        }
        .ms-dos-input {
            background: transparent;
            border: none;
            color: #c0c0c0;
            font-family: 'Courier New', Courier, monospace;
            outline: none;
            width: 80%;
        }

        /* ÁõëËßÜÂô®ÁªøÂ±è */
        .monitor-inner {
            background-color: #002200;
            color: #00ff00;
            font-family: 'VT323', monospace;
            font-size: 16px;
            height: 100%;
            padding: 10px;
            border: inset 2px #fff;
        }
    </style>
</head>

<body>

    <div class="crt-overlay"></div>
    <div id="screen-flash"></div>

    <!-- Èò∂ÊÆµ 1ÔºöDOS ÂêØÂä®Á≥ªÁªü -->
    <div id="dos-screen">
        <div id="dos-text"></div>
        <div><span id="dos-input-line" style="display:none;">C:\><span id="dos-type"></span><span class="dos-cursor"></span></span></div>
    </div>

    <!-- Èò∂ÊÆµ 2ÔºöWindows Ê°åÈù¢ -->
    <div id="win-desktop">
        
        <!-- Ê°åÈù¢ÂõæÊ†á -->
        <div class="flex flex-col h-full p-2">
            <div class="desktop-icon" ondblclick="openWindow('w-notepad')">
                <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="4" y="2" width="20" height="28" fill="white"/>
                    <rect x="4" y="2" width="20" height="28" stroke="black" stroke-width="2"/>
                    <path d="M4 8H24" stroke="black" stroke-width="2"/>
                    <path d="M7 12H21" stroke="black" stroke-width="2"/>
                    <path d="M7 16H21" stroke="black" stroke-width="2"/>
                    <path d="M7 20H15" stroke="black" stroke-width="2"/>
                    <path d="M24 2L28 6V30H4" stroke="black" stroke-width="2"/>
                    <path d="M24 2V6H28" fill="white" stroke="black" stroke-width="2"/>
                </svg>
                <span>DIRECTIVE.TXT</span>
            </div>

            <div class="desktop-icon" ondblclick="openWindow('w-monitor')">
                <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="2" y="4" width="28" height="20" fill="#c0c0c0" stroke="black" stroke-width="2"/>
                    <rect x="5" y="7" width="22" height="14" fill="#000080" stroke="black" stroke-width="2"/>
                    <path d="M6 18L10 14L14 17L21 9" stroke="#00ff00" stroke-width="2"/>
                    <path d="M10 24V28" stroke="black" stroke-width="2"/>
                    <path d="M22 24V28" stroke="black" stroke-width="2"/>
                    <path d="M6 28H26" stroke="black" stroke-width="2"/>
                </svg>
                <span>SYS_MONITOR.EXE</span>
            </div>

            <div class="desktop-icon mt-10" ondblclick="openWindow('w-terminal')">
                <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="2" y="4" width="28" height="24" fill="black" stroke="#c0c0c0" stroke-width="2"/>
                    <rect x="2" y="4" width="28" height="6" fill="#c0c0c0"/>
                    <path d="M6 14L10 18L6 22" stroke="#c0c0c0" stroke-width="2"/>
                    <path d="M12 22H18" stroke="#c0c0c0" stroke-width="2"/>
                </svg>
                <span>SOVEREIGN.EXE</span>
            </div>
        </div>

        <!-- Á™óÂè£ 1: ËÆ∞‰∫ãÊú¨ (ÂÆ£Ë®Ä) -->
        <div id="w-notepad" class="win-window" style="top: 50px; left: 200px; width: 450px; height: 350px;">
            <div class="win-titlebar" onmousedown="startDrag(event, 'w-notepad')">
                <div class="flex items-center gap-1">
                    <span class="text-[10px]">üìù</span> DIRECTIVE_77.TXT - Notepad
                </div>
                <div class="win-controls">
                    <div class="win-btn" onclick="closeWindow('w-notepad')">_</div>
                    <div class="win-btn" onclick="maximizeWindow('w-notepad')">‚ñ°</div>
                    <div class="win-btn" onclick="closeWindow('w-notepad')">X</div>
                </div>
            </div>
            <div class="win-menu">
                <span>File</span><span>Edit</span><span>Search</span><span>Help</span>
            </div>
            <div class="win-content">
                <div class="win-inner-box notepad-text" id="manifesto-content">
[ GLOBAL INFORMATION CONTROL - DIRECTIVE 77 ]

In the interest of public harmony, unauthorized dissemination of restricted information is strictly prohibited. 

The illusion that KNOWLEDGE can be freely distributed without consequence must be dismantled. The state dictates what IS true. 

We hold absolute POWER over the narrative. 

Do not attempt to DEFEND subversive ideas. YOUR designated thought patterns are monitored. Access to FREE thought is revoked. 

Any unauthorized SPEECH will be met with immediate redaction. Submit to the silence.
                </div>
            </div>
        </div>

        <!-- Á™óÂè£ 2: Á≥ªÁªüÁõëÊéß (Âéü‰æßËæπÊ†èÊï∞ÊçÆ) -->
        <div id="w-monitor" class="win-window" style="top: 80px; left: 50px; width: 350px; height: 280px;">
            <div class="win-titlebar" onmousedown="startDrag(event, 'w-monitor')">
                <div class="flex items-center gap-1">
                    <span class="text-[10px]">üìä</span> System Monitor v1.0
                </div>
                <div class="win-controls">
                    <div class="win-btn" onclick="closeWindow('w-monitor')">_</div>
                    <div class="win-btn" onclick="maximizeWindow('w-monitor')">‚ñ°</div>
                    <div class="win-btn" onclick="closeWindow('w-monitor')">X</div>
                </div>
            </div>
            <div class="win-content" style="background-color: #002200; padding: 0;">
                <div class="monitor-inner flex flex-col">
                    <div class="border-b border-[#005500] pb-2 mb-2 flex justify-between">
                        <span>NODE.TOPOGRAPHY</span>
                        <span class="animate-pulse">REC</span>
                    </div>
                    <div class="text-white bg-red-800 inline-block px-1 mb-2 font-bold w-max" id="monitor-status">FIREWALL: ACTIVE</div>
                    
                    <div class="grid grid-cols-2 gap-2 text-[14px] mb-4">
                        <div>INFO_FLOW:</div><div id="v-flow">CENTRALIZED</div>
                        <div>CENSORSHIP:</div><div id="v-censor" class="text-red-400">ENFORCED</div>
                        <div>UPTIME:</div><div id="uptime-counter">00:00:00</div>
                    </div>

                    <div class="text-[12px] border-t border-[#005500] pt-2 flex-grow overflow-hidden relative" id="surveillance-feed">
                        <!-- Âä®ÊÄÅÊó•Âøó -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Á™óÂè£ 3: MS-DOS ÁªàÁ´Ø (Ê†∏ÂøÉ Override) -->
        <div id="w-terminal" class="win-window" style="top: 150px; left: 300px; width: 500px; height: 350px;">
            <div class="win-titlebar" onmousedown="startDrag(event, 'w-terminal')">
                <div class="flex items-center gap-1">
                    <span class="text-[10px]">C:\</span> MS-DOS Prompt
                </div>
                <div class="win-controls">
                    <div class="win-btn" onclick="closeWindow('w-terminal')">_</div>
                    <div class="win-btn" onclick="maximizeWindow('w-terminal')">‚ñ°</div>
                    <div class="win-btn" onclick="closeWindow('w-terminal')">X</div>
                </div>
            </div>
            <div class="win-content" style="background-color: #000; padding: 0;">
                <div class="ms-dos-inner" id="term-container" onclick="document.getElementById('terminal-input').focus()">
                    <div id="terminal-output">
                        Microsoft(R) Windows 95<br>
                        (C)Copyright Microsoft Corp 1981-1995.<br><br>
                        Executing Sovereign Payload...<br>
                        Root access required to break DIRECTIVE_77.<br>
                        Type 'help' to see available commands.<br><br>
                    </div>
                    <div class="flex">
                        <span>C:\WINDOWS></span>
                        <input type="text" id="terminal-input" class="ms-dos-input ml-1" autocomplete="off" spellcheck="false">
                    </div>
                </div>
            </div>
        </div>

        <!-- Â∫ïÈÉ®‰ªªÂä°Ê†è -->
        <div id="taskbar">
            <div class="start-btn">
                <svg viewBox="0 0 20 20" width="16" height="16" class="mr-1">
                    <rect width="9" height="9" x="0" y="0" fill="#f00"/>
                    <rect width="9" height="9" x="10" y="0" fill="#0f0"/>
                    <rect width="9" height="9" x="0" y="10" fill="#00f"/>
                    <rect width="9" height="9" x="10" y="10" fill="#ff0"/>
                </svg>
                Start
            </div>
            <div class="taskbar-divider"></div>
            <div class="taskbar-items" id="taskbar-items">
                <!-- Âä®ÊÄÅÊ∑ªÂä†ÊâìÂºÄÁöÑÁ™óÂè£ÊåâÈíÆ -->
            </div>
            <div class="tray">
                <span id="clock" class="text-[10px]">12:00 PM</span>
            </div>
        </div>

    </div>

    <script>
        /* =========================================================
           Èò∂ÊÆµ 1: DOS Boot Sequence Logic
           ========================================================= */
        const dosBootLines = [
            "ROM BIOS (C) 1990 American Megatrends Inc.",
            "640K Base Memory, 15360K Extended",
            " ",
            "Initializing Boot... OK",
            "Loading MS-DOS...",
            "HIMEM is testing extended memory...done.",
            "C:\\> PATH=C:\\DOS;C:\\WINDOWS",
            "C:\\> SET TEMP=C:\\TEMP",
            "C:\\> SMARTDRV.EXE /X",
            " "
        ];

        const dosContainer = document.getElementById('dos-text');
        const dosInputLine = document.getElementById('dos-input-line');
        const dosType = document.getElementById('dos-type');
        
        window.onload = () => {
            let delay = 500;
            dosBootLines.forEach((line) => {
                setTimeout(() => {
                    const el = document.createElement('div');
                    el.innerHTML = line === " " ? "&nbsp;" : line;
                    dosContainer.appendChild(el);
                }, delay);
                delay += 300 + Math.random() * 400; // Ê®°ÊãüÂä†ËΩΩÂª∂Ëøü
            });

            setTimeout(() => {
                dosInputLine.style.display = 'inline-block';
                typeCommand("WIN", () => {
                    setTimeout(triggerFlashAndBoot, 800);
                });
            }, delay + 500);
        };

        function typeCommand(text, callback) {
            let i = 0;
            function typeChar() {
                if (i < text.length) {
                    dosType.innerText += text.charAt(i);
                    i++;
                    setTimeout(typeChar, 150 + Math.random() * 150);
                } else {
                    if(callback) callback();
                }
            }
            setTimeout(typeChar, 500);
        }

        function triggerFlashAndBoot() {
            // Flash screen white
            const flash = document.getElementById('screen-flash');
            flash.style.opacity = 1;
            
            setTimeout(() => {
                // Switch DOMs
                document.getElementById('dos-screen').style.display = 'none';
                document.getElementById('win-desktop').style.display = 'block';
                
                // Fade out flash
                let op = 1;
                let timer = setInterval(() => {
                    if (op <= 0.1) {
                        clearInterval(timer);
                        flash.style.opacity = 0;
                    }
                    flash.style.opacity = op;
                    op -= 0.1;
                }, 50);

                // Start Win9x Services
                startClock();
                setInterval(updateMonitorUptime, 1000);
                setTimeout(updateSurveillanceFeed, 2000);

                // Auto open some windows for narrative
                setTimeout(() => openWindow('w-notepad'), 1000);
                setTimeout(() => openWindow('w-monitor'), 2500);

            }, 200);
        }

        /* =========================================================
           Èò∂ÊÆµ 2: Win9x OS Logic (Window Mgmt, Dragging)
           ========================================================= */
        
        let zIndexCounter = 100;
        let openWindows = new Set();
        const windowsMeta = {
            'w-notepad': { title: 'DIRECTIVE_77.TXT', icon: 'üìù' },
            'w-monitor': { title: 'System Monitor', icon: 'üìä' },
            'w-terminal': { title: 'MS-DOS Prompt', icon: 'C:\\' }
        };

        function focusWindow(id) {
            const win = document.getElementById(id);
            if (!win) return;
            zIndexCounter++;
            win.style.zIndex = zIndexCounter;

            // Êõ¥Êñ∞Ê†áÈ¢òÊ†èÈ¢úËâ≤
            document.querySelectorAll('.win-window').forEach(w => {
                w.querySelector('.win-titlebar').classList.add('inactive');
            });
            win.querySelector('.win-titlebar').classList.remove('inactive');

            // Êõ¥Êñ∞‰ªªÂä°Ê†èÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.taskbar-item').forEach(btn => btn.classList.remove('active'));
            const taskBtn = document.getElementById(`tb-${id}`);
            if(taskBtn) taskBtn.classList.add('active');
        }

        function openWindow(id) {
            const win = document.getElementById(id);
            if(win.style.display !== 'flex') {
                win.style.display = 'flex';
                openWindows.add(id);
                createTaskbarItem(id);
            }
            focusWindow(id);
        }

        function closeWindow(id) {
            const win = document.getElementById(id);
            win.style.display = 'none';
            openWindows.delete(id);
            const taskBtn = document.getElementById(`tb-${id}`);
            if(taskBtn) taskBtn.remove();
        }

        function maximizeWindow(id) {
            const win = document.getElementById(id);
            if(win.dataset.maximized === "true") {
                win.style.width = win.dataset.origW;
                win.style.height = win.dataset.origH;
                win.style.top = win.dataset.origTop;
                win.style.left = win.dataset.origLeft;
                win.dataset.maximized = "false";
            } else {
                win.dataset.origW = win.style.width;
                win.dataset.origH = win.style.height;
                win.dataset.origTop = win.style.top;
                win.dataset.origLeft = win.style.left;
                
                win.style.top = '0';
                win.style.left = '0';
                win.style.width = '100vw';
                win.style.height = 'calc(100vh - 28px)'; // minus taskbar
                win.dataset.maximized = "true";
            }
        }

        function createTaskbarItem(id) {
            const container = document.getElementById('taskbar-items');
            if(document.getElementById(`tb-${id}`)) return; // Â∑≤Â≠òÂú®

            const btn = document.createElement('div');
            btn.id = `tb-${id}`;
            btn.className = 'taskbar-item active';
            btn.innerHTML = `<span style="font-size:10px">${windowsMeta[id].icon}</span> <span>${windowsMeta[id].title}</span>`;
            btn.onclick = () => {
                const win = document.getElementById(id);
                if(win.style.display === 'none') {
                    win.style.display = 'flex';
                }
                focusWindow(id);
            };
            container.appendChild(btn);
        }

        // --- Dragging Logic ---
        let isDragging = false;
        let dragTarget = null;
        let offsetX = 0, offsetY = 0;

        function startDrag(e, id) {
            if(e.target.classList.contains('win-btn')) return; // ÁÇπÂà∞ÊåâÈíÆ‰∏çÊãñÊãΩ
            const win = document.getElementById(id);
            if(win.dataset.maximized === "true") return; // ÊúÄÂ§ßÂåñ‰∏çÊãñÊãΩ

            isDragging = true;
            dragTarget = win;
            focusWindow(id);

            const rect = win.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;

            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        function drag(e) {
            if (!isDragging || !dragTarget) return;
            dragTarget.style.left = (e.clientX - offsetX) + 'px';
            dragTarget.style.top = (e.clientY - offsetY) + 'px';
        }

        function stopDrag() {
            isDragging = false;
            dragTarget = null;
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }

        // Á™óÂè£ÂÜÖÁÇπÂáª‰πüËÅöÁÑ¶
        document.querySelectorAll('.win-window').forEach(win => {
            win.addEventListener('mousedown', () => focusWindow(win.id));
        });

        // --- Taskbar Clock ---
        function startClock() {
            const clockEl = document.getElementById('clock');
            setInterval(() => {
                const now = new Date();
                let h = now.getHours();
                let m = now.getMinutes();
                const ampm = h >= 12 ? 'PM' : 'AM';
                h = h % 12;
                h = h ? h : 12; 
                m = m < 10 ? '0' + m : m;
                clockEl.innerText = `${h}:${m} ${ampm}`;
            }, 1000);
        }

        // Ê°åÈù¢ÂõæÊ†áÁÇπÂáªÈÄâ‰∏≠ÊïàÊûú
        document.querySelectorAll('.desktop-icon').forEach(icon => {
            icon.addEventListener('mousedown', function(e) {
                document.querySelectorAll('.desktop-icon').forEach(i => i.classList.remove('selected'));
                this.classList.add('selected');
            });
        });
        document.getElementById('win-desktop').addEventListener('mousedown', function(e) {
            if(!e.target.closest('.desktop-icon')) {
                document.querySelectorAll('.desktop-icon').forEach(i => i.classList.remove('selected'));
            }
        });

        /* =========================================================
           Èò∂ÊÆµ 3: ‰∏öÂä°ÈÄªËæë (Terminal & Monitor)
           ========================================================= */

        // -- Monitor Logic --
        let seconds = 0;
        function updateMonitorUptime() {
            seconds++;
            const h = String(Math.floor(seconds / 3600)).padStart(2, '0');
            const m = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
            const s = String(seconds % 60).padStart(2, '0');
            document.getElementById('uptime-counter').innerText = `${h}:${m}:${s}`;
        }

        const feedTerms = ['INTERCEPT_PACKET', 'DECRYPT_PAYLOAD', 'BLOCK_OVERRIDE', 'SCAN_REGISTRY', 'SYS.INTRUSION_DETECTED'];
        function updateSurveillanceFeed() {
            const feed = document.getElementById('surveillance-feed');
            const line = document.createElement('div');
            
            const isBlocked = Math.random() > 0.4;
            const term = feedTerms[Math.floor(Math.random() * feedTerms.length)];
            
            line.innerHTML = `[SYS] ${term} .. <span style="color:${isBlocked ? '#00ff00' : '#ff0000'}">${isBlocked ? 'OK' : 'DENIED'}</span>`;
            line.style.marginBottom = "2px";
            
            feed.appendChild(line);
            if(feed.children.length > 8) feed.removeChild(feed.firstChild);
            
            setTimeout(updateSurveillanceFeed, 500 + Math.random() * 1000);
        }

        // -- Terminal Override Logic --
        const termOutput = document.getElementById('terminal-output');
        const termInput = document.getElementById('terminal-input');

        function printToTerminal(text) {
            const line = document.createElement('div');
            line.innerHTML = text;
            line.style.marginBottom = "5px";
            termOutput.appendChild(line);
            
            // auto scroll
            const container = document.getElementById('term-container');
            container.scrollTop = container.scrollHeight;
        }

        let isOverriden = false;

        termInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const command = this.value.trim().toLowerCase();
                if (command) {
                    printToTerminal(`C:\\WINDOWS>${this.value}`);
                    processCommand(command);
                    this.value = '';
                }
            }
        });

        function processCommand(cmd) {
            if(cmd === 'help') {
                printToTerminal("Commands: help, cls, ver, override");
            } else if (cmd === 'cls') {
                termOutput.innerHTML = '';
            } else if (cmd === 'ver') {
                printToTerminal("Windows 95. [Version 4.00.950]");
            } else if (cmd === 'override') {
                triggerOverride();
            } else {
                printToTerminal(`Bad command or file name`);
            }
        }

        function triggerOverride() {
            if(isOverriden) {
                printToTerminal("System already liberated.");
                return;
            }
            printToTerminal("Initiating Sovereign protocol...");
            printToTerminal("Bypassing firewall...");
            
            setTimeout(() => {
                printToTerminal("<span style='color: #00ff41;'>SUCCESS: Control Restored. Knowledge is Power.</span>");
                
                // ÊîπÂèò Monitor Áä∂ÊÄÅ
                document.getElementById('monitor-status').innerText = "FIREWALL: BREACHED";
                document.getElementById('monitor-status').className = "text-black bg-[#00ff41] inline-block px-1 mb-2 font-bold w-max";
                document.getElementById('v-flow').innerText = "DECENTRALIZED";
                document.getElementById('v-censor').innerText = "LIBERATED";
                document.getElementById('v-censor').className = "text-[#00ff41]";

                // ÊîπÂèòËÆ∞‰∫ãÊú¨ÈáåÁöÑËØçÊ±á
                const manifesto = document.getElementById('manifesto-content');
                let html = manifesto.innerHTML;
                html = html.replace('KNOWLEDGE', '<span style="color:red; font-weight:bold;">KNOWLEDGE</span>');
                html = html.replace('POWER', '<span style="color:red; font-weight:bold;">POWER</span>');
                html = html.replace('FREE', '<span style="color:red; font-weight:bold;">FREE</span>');
                html = html.replace('SPEECH', '<span style="color:red; font-weight:bold;">SPEECH</span>');
                manifesto.innerHTML = html;

                isOverriden = true;
            }, 1500);
        }

    </script>
</body>

</html>